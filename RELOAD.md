# 🔄 重新加载插件并测试

## 刚才做的改进

✅ 添加了新的YouTube内部API获取方式  
✅ 改进了多种字幕获取方法的回退机制  
✅ 增强了调试日志输出  
✅ 修复了字幕数据解析逻辑  

## 📝 立即操作步骤

### 1. 重新加载插件（必须！）

1. 打开 `chrome://extensions/`
2. 找到 **YouTube 转录侧边栏** 插件
3. 点击 **刷新/重新加载** 按钮 🔄
4. 确认没有任何错误提示

### 2. 刷新YouTube页面

1. 回到你正在看的YouTube视频页面
2. **完全刷新页面**（Cmd+Shift+R 或 Ctrl+Shift+R）
3. 等待 3-5 秒让页面完全加载

### 3. 检查侧边栏

右侧应该出现：
- ✅ 黑色背景的侧边栏
- ✅ "转录文本"标题
- ✅ 字幕内容（不再是"正在加载"）

### 4. 打开控制台查看详细日志

按 **F12** 或 **Cmd+Option+I**，然后：

1. 切换到 **Console** 标签
2. 查找以下日志：
   ```
   [YouTube转录] 初始化开始...
   [YouTube转录] 开始获取字幕...
   [YouTube转录] 尝试使用API获取字幕...
   [YouTube转录] 找到API Key，发起请求...
   [YouTube转录] API返回数据: ...
   ```

### 5. 如果看到"未找到API Key"

这是正常的，会自动使用备用方法：
```
[YouTube转录] 从window对象获取成功
[YouTube转录] 成功获取字幕，共 XX 条
```

## 🔍 预期结果

### 成功的标志：
- 侧边栏显示完整的字幕列表
- 每条字幕都有时间戳（如 00:05）
- 播放视频时，当前字幕会高亮（蓝色背景）
- 点击字幕会跳转到对应时间点

### 失败的情况：
如果仍显示"正在加载字幕..."或"此视频没有可用的字幕"：
1. 检查控制台的具体错误信息
2. 截图控制台内容
3. 尝试其他有字幕的YouTube视频

## 🎯 推荐测试视频

这些视频肯定有字幕：
- TED演讲（如 https://www.youtube.com/watch?v=8S0FDjFBj8o）
- 官方教程视频
- 新闻频道视频

## 💡 调试提示

如果控制台显示：
- **"未找到视频元素"** → 等待几秒后会自动重试
- **"此视频没有字幕"** → 这个视频确实没有字幕，换一个
- **"API请求失败"** → 会自动使用备用方法
- **"解析失败"** → 将错误信息截图给我

## ✨ 新功能

现在插件会：
1. 首先尝试使用YouTube的内部API（最快最准确）
2. 如果失败，从ytInitialPlayerResponse获取
3. 如果还失败，从页面Script标签提取
4. 显示详细的加载状态和错误信息

---

**请按上述步骤重新加载插件并测试！**